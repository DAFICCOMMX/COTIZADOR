<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cotizador DAFIC | Servicios Integrales</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;800&display=swap" rel="stylesheet">

<style>
  /* --- ESTILOS GENERALES --- */
  :root {
    --bg-color: #e6e6e6;
    --text-main: #333;
    --text-light: #777;
    --shadow-light: rgba(255, 255, 255, 0.8);
    --shadow-dark: rgba(163, 177, 198, 0.6);
    --accent-color: #222;
    --promo-color: #d32f2f;
    --new-color: #2E7D32;
    --discount-text: #FF0000; 
  }

  body {
    background-color: var(--bg-color);
    margin: 0;
    font-family: 'Montserrat', sans-serif;
    color: var(--text-main);
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  .dafic-pricing-container {
    max-width: 1100px;
    margin: 0 auto;
    text-align: center;
    padding: 80px 20px;
    min-height: 100vh;
  }

  /* LOGO */
  .dafic-logo-wrapper { margin-bottom: 60px; animation: fadeInDown 1s ease-out; }
  .dafic-logo-img {
    max-width: 250px; height: auto; display: block; margin: 0 auto;
    filter: drop-shadow(8px 8px 15px var(--shadow-dark));
    transition: transform 0.3s ease;
  }
  .dafic-logo-img:hover { transform: scale(1.02); }

  /* NAVEGACI√ìN */
  .dafic-toggle-wrapper {
    display: inline-flex; background-color: var(--bg-color); border-radius: 50px;
    padding: 8px; margin-bottom: 60px; gap: 20px;
    box-shadow: inset 6px 6px 12px var(--shadow-dark), inset -6px -6px 12px var(--shadow-light);
  }
  .dafic-toggle-btn {
    padding: 15px 40px; background: transparent; border: none; cursor: pointer;
    font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 700; letter-spacing: 1px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); outline: none; color: var(--text-light);
    border-radius: 40px; text-transform: uppercase;
  }
  .dafic-toggle-btn.active {
    color: var(--accent-color); background-color: var(--bg-color);
    box-shadow: 6px 6px 12px var(--shadow-dark), -6px -6px 12px var(--shadow-light);
    transform: scale(1.03);
  }

  .selection-instruction {
    font-size: 15px; color: #888; margin-top: 50px; font-weight: 500; letter-spacing: 0.5px; animation: fadeIn 2s;
  }

  /* SEPARADOR */
  .neumorphic-divider {
    height: 2px; margin: 60px auto; max-width: 80%; background: var(--bg-color);
    box-shadow: inset 2px 2px 4px var(--shadow-dark), inset -2px -2px 4px var(--shadow-light);
    border-radius: 10px; opacity: 0.5;
  }

  /* GRID TARJETAS */
  .dafic-cards-grid { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-bottom: 60px; }
  
  .dafic-card {
    background-color: var(--bg-color); border-radius: 25px; padding: 50px 25px 35px 25px; width: 260px;
    text-align: left; cursor: pointer; position: relative; user-select: none;
    border: 1px solid rgba(255,255,255,0.3);
    box-shadow: 10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    opacity: 0; animation: fadeInUp 0.6s forwards; overflow: hidden;
  }
  
  /* SHEEN */
  .dafic-card::before {
    content: ''; position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
    background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.4) 50%, transparent 100%);
    transform: skewX(-25deg); transition: all 0.7s ease; display: block; z-index: 1; pointer-events: none;
  }
  .dafic-card:hover::before { left: 150%; }

  .dafic-card:hover { transform: translateY(-8px); box-shadow: 18px 18px 30px var(--shadow-dark), -18px -18px 30px var(--shadow-light); }
  .dafic-card.selected { box-shadow: inset 6px 6px 12px var(--shadow-dark), inset -6px -6px 12px var(--shadow-light); border-color: transparent; transform: scale(0.98); }
  
  /* BADGES */
  .popular-badge {
    position: absolute; top: 0; left: 50%; transform: translateX(-50%);
    background: var(--accent-color); color: var(--bg-color);
    font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
    padding: 6px 15px; border-radius: 0 0 15px 15px; box-shadow: 4px 4px 8px var(--shadow-dark); z-index: 3;
  }
  .promo-badge {
    position: absolute; top: 0; left: 50%; transform: translateX(-50%);
    background: var(--promo-color); color: #fff;
    font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
    padding: 6px 15px; border-radius: 0 0 15px 15px; box-shadow: 4px 4px 8px var(--shadow-dark); z-index: 3;
    width: auto; text-align: center; white-space: nowrap;
  }
  .new-badge {
    position: absolute; top: 0; left: 50%; transform: translateX(-50%);
    background: var(--new-color); color: #fff;
    font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px;
    padding: 6px 15px; border-radius: 0 0 15px 15px; box-shadow: 4px 4px 8px var(--shadow-dark); z-index: 3;
  }

  .card-check-icon {
    position: absolute; top: 35px; right: 25px; width: 24px; height: 24px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: all 0.3s;
    background: var(--bg-color); z-index: 2;
    box-shadow: 3px 3px 6px var(--shadow-dark), -3px -3px 6px var(--shadow-light);
  }
  .dafic-card.selected .card-check-icon {
    background: var(--bg-color); color: var(--accent-color);
    box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light);
  }
  .dafic-card.selected .card-check-icon::after { content: "‚úì"; font-size: 14px; font-weight: 800; }

  .card-title { font-size: 13px; font-weight: 700; margin: 15px 0 10px 0; text-transform: uppercase; letter-spacing: 1px; color: #888; position: relative; z-index: 2;}
  .card-price-range { font-size: 22px; font-weight: 800; color: #222; display: block; margin-bottom: 15px; letter-spacing: -0.5px; position: relative; z-index: 2; text-shadow: 1px 1px 1px var(--shadow-light);}
  .card-desc { font-size: 12px; color: #555; line-height: 1.5; position: relative; z-index: 2; font-weight: 500;}

  /* CALCULADORA */
  .calculator-section {
    background-color: var(--bg-color); border-radius: 40px; padding: 50px; max-width: 850px;
    margin: 0 auto; text-align: left; display: none;
    box-shadow: 20px 20px 60px var(--shadow-dark), -20px -20px 60px var(--shadow-light);
    animation: slideUpFade 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .calc-header { margin-bottom: 35px; font-size: 22px; font-weight: 300; color: #333; border-bottom: 1px solid #d1d1d1; padding-bottom: 20px; }
  .calc-header strong { font-weight: 800; }

  .calc-option-card {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 25px; padding: 25px 30px; border-radius: 20px;
    background-color: var(--bg-color); cursor: pointer; transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.4);
    box-shadow: 8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light);
  }
  .calc-option-card:hover { transform: translateY(-3px); box-shadow: 12px 12px 24px var(--shadow-dark), -12px -12px 24px var(--shadow-light); }
  .calc-option-card.active {
    box-shadow: inset 6px 6px 12px var(--shadow-dark), inset -6px -6px 12px var(--shadow-light);
    border-color: transparent; transform: translateY(1px);
  }

  .option-indicator {
    width: 26px; height: 26px; border-radius: 50%; background: var(--bg-color);
    box-shadow: 3px 3px 6px var(--shadow-dark), -3px -3px 6px var(--shadow-light);
    display: flex; align-items: center; justify-content: center; margin-right: 25px; transition: all 0.3s; color: transparent;
  }
  .calc-option-card.active .option-indicator {
    background: var(--bg-color); color: var(--accent-color);
    box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light);
  }
  .calc-option-card.active .option-indicator::after { content: "‚úì"; font-size: 14px; font-weight: 800; }
  
  .option-title { display: block; font-size: 16px; font-weight: 700; color: #333; margin-bottom: 5px; }
  .option-subtitle { font-size: 13px; color: #777; font-weight: 500; }
  .option-price { font-size: 20px; font-weight: 700; color: #333; }

  .qty-control {
    display: flex; align-items: center; background: var(--bg-color); border-radius: 30px;
    padding: 5px; margin-left: 20px; visibility: hidden; opacity: 0; transition: all 0.3s;
    box-shadow: inset 4px 4px 8px var(--shadow-dark), inset -4px -4px 8px var(--shadow-light);
  }
  .qty-control.visible { visibility: visible; opacity: 1; }
  .qty-btn {
    background: var(--bg-color); border: none; width: 35px; height: 35px; border-radius: 50%;
    font-size: 18px; cursor: pointer; color: #333;
    box-shadow: 4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light);
    transition: all 0.2s; display: flex; align-items: center; justify-content: center;
  }
  .qty-btn:active { box-shadow: inset 2px 2px 5px var(--shadow-dark), inset -2px -2px 5px var(--shadow-light); transform: scale(0.95); }
  
  .num-input { width: 45px; text-align: center; border: none; font-size: 18px; font-weight: 700; background: transparent; color: #333; font-family: 'Montserrat', sans-serif;}

  .total-display {
    font-size: 52px; font-weight: 800; text-align: right; margin-top: 40px; color: #222; letter-spacing: -2px;
    text-shadow: 2px 2px 2px var(--shadow-light);
  }
  .total-label { font-size: 12px; font-weight: 700; color: #999; text-transform: uppercase; letter-spacing: 3px;}
  .subtotal-note { text-align: right; font-size: 12px; color: #999; margin-bottom: 40px; font-style: italic; font-weight: 500;}
  
  .discount-alert { color: var(--discount-text); font-weight: 800; font-size: 15px; margin-top: 8px; display: block; text-transform: uppercase; letter-spacing: 0.5px;}

  /* FORMULARIO Y CALENDARIO */
  .form-section { margin-top: 40px; padding-top: 40px; border-top: 1px solid #d1d1d1; }
  .form-title { font-size: 18px; font-weight: 800; margin-bottom: 20px; text-transform: uppercase; color: #444; letter-spacing: 1px;}
  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 25px; }
  .form-input, .form-select {
    width: 100%; padding: 15px 20px; border-radius: 15px; border: none; background: var(--bg-color);
    box-shadow: inset 5px 5px 10px var(--shadow-dark), inset -5px -5px 10px var(--shadow-light);
    color: #333; font-size: 14px; outline: none; box-sizing: border-box; font-family: 'Montserrat', sans-serif; font-weight: 500;
    transition: box-shadow 0.3s;
  }
  .form-input:focus, .form-select:focus { box-shadow: inset 8px 8px 15px var(--shadow-dark), inset -8px -8px 15px var(--shadow-light); }

  .custom-calendar {
    background: var(--bg-color); border-radius: 25px; padding: 25px;
    box-shadow: 8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light);
    margin-bottom: 25px;
  }
  .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
  .month-label { font-weight: 800; text-transform: uppercase; color: #333; letter-spacing: 1px; }
  .cal-nav {
    background: var(--bg-color); border: none; cursor: pointer; width: 35px; height: 35px;
    border-radius: 50%; box-shadow: 4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light);
    font-weight: 700; color: #555; transition: transform 0.2s;
  }
  .cal-nav:hover { transform: scale(1.1); }
  .calendar-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); margin-bottom: 15px; text-align: center; font-size: 12px; font-weight: 800; color: #999; }
  .calendar-days { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; }
  .day-cell {
    height: 38px; display: flex; align-items: center; justify-content: center; border-radius: 12px;
    cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.2s; color: #666;
  }
  .day-cell:hover:not(.disabled):not(.selected) { background: #e0e0e0; transform: translateY(-2px); }
  .day-cell.selected {
    background: var(--bg-color); color: var(--accent-color); font-weight: 800;
    box-shadow: inset 4px 4px 8px var(--shadow-dark), inset -4px -4px 8px var(--shadow-light);
  }
  .day-cell.disabled { color: #ccc; cursor: not-allowed; font-weight: 400;}

  .time-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; margin-top: 20px; }
  .time-btn {
    padding: 12px; border-radius: 15px; background: var(--bg-color); border: none; cursor: pointer;
    font-size: 13px; font-weight: 600; color: #666; font-family: 'Montserrat', sans-serif;
    box-shadow: 5px 5px 10px var(--shadow-dark), -5px -5px 10px var(--shadow-light);
    transition: all 0.2s;
  }
  .time-btn:hover { transform: translateY(-3px); color: var(--accent-color); }
  .time-btn.selected {
    background: var(--bg-color); color: var(--accent-color);
    box-shadow: inset 4px 4px 8px var(--shadow-dark), inset -4px -4px 8px var(--shadow-light);
    border: 1px solid transparent;
  }

  .action-buttons { display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 50px; }
  .btn-whatsapp-big {
    padding: 22px 65px; text-decoration: none; font-weight: 800; text-transform: uppercase;
    font-size: 15px; letter-spacing: 1.5px; cursor: pointer; border-radius: 60px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: inline-flex; align-items: center; gap: 15px;
    background-color: var(--bg-color); color: #25D366;
    box-shadow: 10px 10px 20px var(--shadow-dark), -10px -10px 20px var(--shadow-light);
    border: 1px solid rgba(255,255,255,0.5);
  }
  .btn-whatsapp-big:hover { transform: translateY(-5px) scale(1.02); color: #1ebc57; }

  .hidden { display: none !important; }
  .dafic-card { opacity: 0; animation: fadeInUp 0.6s forwards; }
  .dafic-card:nth-child(1) { animation-delay: 0.1s; } 
  .dafic-card:nth-child(2) { animation-delay: 0.15s; }
  .dafic-card:nth-child(3) { animation-delay: 0.2s; } 
  .dafic-card:nth-child(4) { animation-delay: 0.25s; }
  .dafic-card:nth-child(5) { animation-delay: 0.3s; }
  .dafic-card:nth-child(6) { animation-delay: 0.35s; }
  .dafic-card:nth-child(7) { animation-delay: 0.4s; }
  .dafic-card:nth-child(8) { animation-delay: 0.45s; }
  
  @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes fadeInUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes slideUpFade { from { opacity: 0; transform: translateY(60px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
  @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }
</style>
</head>
<body>

<div class="dafic-pricing-container">
  
  <div class="dafic-logo-wrapper">
    <img src="https://raw.githubusercontent.com/DAFICCOMMX/COTIZADOR/main/logo.png" 
         alt="DAFIC" class="dafic-logo-img"
         onerror="this.onerror=null; this.src='COTIZADOR/logo.png';">
  </div>
  
  <div class="dafic-toggle-wrapper">
    <button class="dafic-toggle-btn" onclick="cambiarTipo('fisica', this)">Persona F√≠sica</button>
    <button class="dafic-toggle-btn" onclick="cambiarTipo('moral', this)">Persona Moral</button>
  </div>

  <div id="mensaje-inicial" class="selection-instruction">Seleccione su perfil para comenzar</div>

  <div id="grid-fisica" class="dafic-cards-grid hidden">
    <div class="dafic-card" onclick="seleccionarPlan(this, 600, 'RESICO', 1000, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">R√©gimen Simplificado</div>
      <span class="card-price-range">$600 - $2,000</span>
      <p class="card-desc">Ideal para emprendedores y ventas al p√∫blico.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 1200, 'Act. Empresarial', 1000, '')">
      <div class="popular-badge">M√°s Popular</div>
      <div class="card-check-icon"></div>
      <div class="card-title">Actividad Empresarial</div>
      <span class="card-price-range">$1,200 - $6,000</span>
      <p class="card-desc">Profesionales independientes y negocios.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 1000, 'Plataformas', 1000, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Plataformas Digitales</div>
      <span class="card-price-range">$1,000 - $7,000</span>
      <p class="card-desc">Uber, Airbnb, Amazon, Mercado Libre.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 1000, 'Arrendamiento', 1000, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Arrendamiento</div>
      <span class="card-price-range">$1,000 - $9,000</span>
      <p class="card-desc">Gesti√≥n fiscal para renta de inmuebles.</p>
    </div>
    
    <div class="dafic-card" onclick="seleccionarPlan(this, 1000, 'Declaraci√≥n Anual PF', 0, '')">
      <div class="promo-badge">Oferta hasta 28 Feb</div>
      <div class="card-check-icon"></div>
      <div class="card-title">Declaraci√≥n Anual</div>
      <span class="card-price-range">$1,000 <small style="font-size:12px; color:#777; font-weight:400;">(Reg. $1,500)</small></span>
      <p class="card-desc">Sueldos y Salarios. <strong>Incluye Generaci√≥n de Contrase√±a GRATIS.</strong></p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 1500, 'Devoluci√≥n Impuestos PF', 0, ' + 15% de la devoluci√≥n')">
      <div class="card-check-icon"></div>
      <div class="card-title">Devoluci√≥n Impuestos</div>
      <span class="card-price-range">$1,500 <small style="font-size:14px;">+ 15%</small></span>
      <p class="card-desc">Gesti√≥n integral para la recuperaci√≥n de tu saldo a favor.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 2000, 'Regularizaci√≥n Fiscal PF', 0, '')">
      <div class="new-badge">Recomendado</div>
      <div class="card-check-icon"></div>
      <div class="card-title">Regularizaci√≥n</div>
      <span class="card-price-range">Desde $2,000</span>
      <p class="card-desc">Ponte al corriente con declaraciones de a√±os anteriores.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 800, 'Renovaci√≥n e.Firma', 0, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Renovaci√≥n e.Firma</div>
      <span class="card-price-range">$800</span>
      <p class="card-desc">Tr√°mite en l√≠nea para renovar tu firma electr√≥nica vencida.</p>
    </div>
    
    <div class="dafic-card" onclick="seleccionarPlan(this, 500, 'Cita SAT', 0, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Citas SAT</div>
      <span class="card-price-range">$500</span>
      <p class="card-desc">Agendamos tu cita para firma electr√≥nica o tr√°mites.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 500, 'Tr√°mite IMSS', 0, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Tr√°mite IMSS</div>
      <span class="card-price-range">$500</span>
      <p class="card-desc">Altas, bajas y gesti√≥n de seguridad social.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 200, 'Generaci√≥n Contrase√±a', 0, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Generar Contrase√±a</div>
      <span class="card-price-range">$200</span>
      <p class="card-desc">Acceso al portal del SAT. (Gratis si contratas anual).</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 800, 'Asesor√≠a 1:1', 0, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Asesor√≠a 1 a 1</div>
      <span class="card-price-range">$800 <small style="font-size:12px;">/ hora</small></span>
      <p class="card-desc">Sesi√≥n por Zoom para resolver dudas espec√≠ficas.</p>
    </div>
  </div>

  <div id="grid-moral" class="dafic-cards-grid hidden">
    <div class="dafic-card" onclick="seleccionarPlan(this, 3000, 'Contabilidad Persona Moral', 2000, '')">
      <div class="card-check-icon"></div>
      <div class="card-title">Contabilidad</div>
      <span class="card-price-range">$3,000 - $30,000</span>
      <p class="card-desc">Cumplimiento total para Sociedades.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 7000, 'Estrategia Fiscal', 2000, '')">
      <div class="popular-badge">Recomendado</div>
      <div class="card-check-icon"></div>
      <div class="card-title">Estrategia Fiscal</div>
      <span class="card-price-range">$7,000 - $35,000</span>
      <p class="card-desc">Reingenier√≠a fiscal y optimizaci√≥n (Solo Asesor√≠a).</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 3500, 'Devoluci√≥n Impuestos PM', 0, ' + 20% de la devoluci√≥n')">
      <div class="card-check-icon"></div>
      <div class="card-title">Devoluci√≥n Impuestos</div>
      <span class="card-price-range">$3,500 <small style="font-size:14px;">+ 20%</small></span>
      <p class="card-desc">Recuperaci√≥n de saldos para Personas Morales.</p>
    </div>
    <div class="dafic-card" onclick="seleccionarPlan(this, 4000, 'Regularizaci√≥n Fiscal PM', 0, '')">
      <div class="new-badge">Importante</div>
      <div class="card-check-icon"></div>
      <div class="card-title">Regularizaci√≥n</div>
      <span class="card-price-range">Desde $4,000</span>
      <p class="card-desc">Ponte al corriente y evita multas o cancelaciones.</p>
    </div>
  </div>

  <div class="neumorphic-divider"></div>

  <div id="zona-calculadora" class="calculator-section">
    <div class="calc-header">Resumen: <strong><span id="nombre-plan-display">---</span></strong></div>

    <div id="wrapper-regimen-reg" style="display:none; margin-bottom:25px;">
      <span class="option-title" style="margin-bottom:15px;">Selecciona tu R√©gimen Fiscal</span>
      <select id="regimenRegularizacion" class="form-select" onchange="cambiarPrecioRegularizacion()">
        <option value="600">RESICO ($600/mes)</option>
        <option value="1200" selected>Actividad Empresarial ($1,200/mes)</option>
        <option value="1000">Plataformas Digitales ($1,000/mes)</option>
        <option value="1000">Arrendamiento ($1,000/mes)</option>
      </select>
    </div>

    <div class="calc-option-card active" id="card-regularizacion" style="display:none;" onclick="event.stopPropagation()">
      <div style="display:flex; align-items:center;">
        <div class="option-indicator" style="background:var(--accent-color); color:white;">‚úì</div>
        <div class="option-content">
          <span class="option-title">Periodo a Regularizar</span>
          <span class="option-subtitle">Entre m√°s meses, mayor descuento.</span>
          <span id="txt-descuento" class="discount-alert"></span>
        </div>
      </div>
      <div id="wrapper-meses" class="qty-control visible">
        <button class="qty-btn" onclick="cambiarMeses(-1)">-</button>
        <input type="number" id="numMesesReg" class="num-input" value="1" readonly>
        <button class="qty-btn" onclick="cambiarMeses(1)">+</button>
      </div>
      <div class="option-price" style="min-width: 80px; text-align: right;">meses</div>
    </div>

    <div class="calc-option-card active" id="card-diagnostico" onclick="toggleOption('checkDiagnostico', 'card-diagnostico')">
      <div style="display:flex; align-items:center;"><div class="option-indicator"></div><div class="option-content"><span class="option-title">Diagn√≥stico Inicial</span><span class="option-subtitle">Pago √∫nico (Bonificable 100%)</span></div></div>
      <div class="option-price">+ $<span id="costo-diagnostico">0</span></div>
      <input type="checkbox" id="checkDiagnostico" style="display:none;" checked>
    </div>

    <div class="calc-option-card" id="card-nomina" onclick="toggleOption('checkNomina', 'card-nomina')">
      <div style="display:flex; align-items:center;"><div class="option-indicator"></div><div class="option-content"><span class="option-title">N√≥mina / Empleados</span><span class="option-subtitle">¬øTienes personal? ($30 c/u)</span></div></div>
      <div id="wrapper-contador" class="qty-control" onclick="event.stopPropagation()"><button class="qty-btn" onclick="cambiarEmpleados(-1)">-</button><input type="number" id="numEmpleados" class="num-input" value="1" readonly><button class="qty-btn" onclick="cambiarEmpleados(1)">+</button></div>
      <div class="option-price">+ $<span id="costo-nomina">0</span></div>
      <input type="checkbox" id="checkNomina" style="display:none;">
    </div>

    <div class="total-display"><span class="total-label" id="label-total">Inversi√≥n Estimada</span><br><span id="total-final">$0</span> MXN</div>
    <div id="nota-diagnostico" class="subtotal-note" style="display:none;">* Este monto cubre √∫nicamente el Diagn√≥stico.</div>

    <div class="form-section">
      <div class="form-title">Informaci√≥n para tu Cita</div>
      <div class="form-grid">
        <input type="text" id="clientName" class="form-input" placeholder="Nombre Completo" oninput="actualizarLinks()">
        <input type="text" id="clientGiro" class="form-input" placeholder="Giro del Negocio" oninput="actualizarLinks()">
        <select id="clientStatus" class="form-select" onchange="verificarStatus()">
          <option value="" disabled selected>¬øEst√°s dado de alta en el SAT?</option>
          <option value="No">No, a√∫n no</option>
          <option value="Si">S√≠, ya estoy dado de alta</option>
        </select>
        <div id="divAtraso" style="display:none;">
          <select id="clientAtraso" class="form-select" onchange="actualizarLinks()">
            <option value="" disabled selected>¬øTienes meses de atraso?</option>
            <option value="Sin Atraso">No, voy al corriente</option>
            <option value="Con Atraso">S√≠, tengo declaraciones pendientes</option>
          </select>
        </div>
      </div>
    </div>

    <div class="form-section">
      <div class="form-title">Agenda tu Cita (Lun-Sab | 6:30PM - 11:30PM)</div>
      <div class="custom-calendar">
        <div class="calendar-header"><button class="cal-nav" onclick="prevMonth()"><</button><span class="month-label" id="calendar-month-year"></span><button class="cal-nav" onclick="nextMonth()">></button></div>
        <div class="calendar-weekdays"><div>Do</div><div>Lu</div><div>Ma</div><div>Mi</div><div>Ju</div><div>Vi</div><div>Sa</div></div>
        <div class="calendar-days" id="calendar-days"></div>
      </div>
      <label style="font-size:12px; font-weight:bold; color:#777; display:block; text-transform:uppercase; letter-spacing:1px;">Hora Seleccionada: <span id="txt-hora-sel" style="color:#000;">--</span></label>
      <div class="time-grid" id="timeGrid">
        <button class="time-btn" onclick="seleccionarHora('18:30', this)">06:30 PM</button>
        <button class="time-btn" onclick="seleccionarHora('19:00', this)">07:00 PM</button>
        <button class="time-btn" onclick="seleccionarHora('19:30', this)">07:30 PM</button>
        <button class="time-btn" onclick="seleccionarHora('20:00', this)">08:00 PM</button>
        <button class="time-btn" onclick="seleccionarHora('20:30', this)">08:30 PM</button>
        <button class="time-btn" onclick="seleccionarHora('21:00', this)">09:00 PM</button>
        <button class="time-btn" onclick="seleccionarHora('21:30', this)">09:30 PM</button>
        <button class="time-btn" onclick="seleccionarHora('22:00', this)">10:00 PM</button>
        <button class="time-btn" onclick="seleccionarHora('22:30', this)">10:30 PM</button>
        <button class="time-btn" onclick="seleccionarHora('23:00', this)">11:00 PM</button>
        <button class="time-btn" onclick="seleccionarHora('23:30', this)">11:30 PM</button>
      </div>
    </div>

    <div class="action-buttons">
      <a href="#" id="btn-whatsapp-link" target="_blank" class="btn-whatsapp-big">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12.031 6.172c-3.181 0-5.767 2.586-5.768 5.766-.001 1.298.38 2.27 1.019 3.287l-.711 2.592 2.664-.698c.969.591 1.746.864 2.792.864 3.19 0 5.775-2.586 5.775-5.766.001-3.18-2.587-5.767-5.771-5.767zm12 5.766c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-4.586 3.193c-.237-.118-1.402-.693-1.619-.772-.217-.079-.375-.118-.533.118-.158.237-.612.772-.75.93-.138.157-.276.177-.513.059-.237-.118-1.002-.37-1.908-1.177-.704-.627-1.18-1.401-1.318-1.637-.138-.237-.007-.365.112-.483.107-.107.237-.276.355-.414.118-.138.158-.237.237-.394.079-.158.04-.296-.02-.414-.059-.118-.533-1.286-.73-1.761-.192-.464-.386-.401-.533-.408-.138-.007-.296-.007-.454-.007-.158 0-.414.059-.632.296-.217.237-.829.809-.829 1.974 0 1.165.849 2.29 .967 2.448.118.157 1.671 2.551 4.049 3.577.566.244 1.008.391 1.353.501.572.181 1.093.155 1.505.094.461-.068 1.402-.573 1.6-1.127.198-.553.198-1.028.139-1.127-.059-.099-.217-.158-.454-.277z"/></svg>
        Confirmar Cita por WhatsApp
      </a>
    </div>
  </div>
</div>

<script>
  let precioPlanBase = 0; let nombrePlan = ""; let baseDiagnostico = 0;
  let horaSeleccionada = ""; let fechaSeleccionada = "";
  let textoExtraPrecio = ""; 

  const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
  let currentDate = new Date();
  let currMonth = currentDate.getMonth();
  let currYear = currentDate.getFullYear();

  function renderCalendar() {
    const firstDay = new Date(currYear, currMonth, 1).getDay(); 
    const daysInMonth = new Date(currYear, currMonth + 1, 0).getDate();
    const calendarDays = document.getElementById('calendar-days');
    document.getElementById('calendar-month-year').innerText = `${monthNames[currMonth]} ${currYear}`;
    calendarDays.innerHTML = "";
    for (let i = 0; i < firstDay; i++) { calendarDays.appendChild(document.createElement('div')); }
    for (let i = 1; i <= daysInMonth; i++) {
        let dayDiv = document.createElement('div');
        dayDiv.innerText = i; dayDiv.classList.add('day-cell');
        let checkDate = new Date(currYear, currMonth, i);
        if (checkDate.getDay() === 0) dayDiv.classList.add('disabled');
        else dayDiv.onclick = function() { seleccionarFecha(i, this); };
        calendarDays.appendChild(dayDiv);
    }
  }
  function prevMonth() { currMonth--; if(currMonth < 0) { currMonth = 11; currYear--; } renderCalendar(); }
  function nextMonth() { currMonth++; if(currMonth > 11) { currMonth = 0; currYear++; } renderCalendar(); }
  function seleccionarFecha(dia, elemento) {
    document.querySelectorAll('.day-cell').forEach(d => d.classList.remove('selected'));
    elemento.classList.add('selected');
    fechaSeleccionada = `${dia} de ${monthNames[currMonth]} ${currYear}`;
    actualizarLinks();
  }
  renderCalendar();

  function cambiarTipo(tipo, btn) {
    document.getElementById('mensaje-inicial').style.display = 'none';
    document.getElementById('zona-calculadora').style.display = 'none';
    resetearSeleccion();
    document.getElementById('grid-fisica').classList.add('hidden');
    document.getElementById('grid-moral').classList.add('hidden');
    if (tipo === 'fisica') document.getElementById('grid-fisica').classList.remove('hidden');
    else document.getElementById('grid-moral').classList.remove('hidden');
    document.querySelectorAll('.dafic-toggle-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.querySelector('.neumorphic-divider').style.display = 'none';
  }

  function seleccionarPlan(ele, prec, nom, diag, txtExtra) {
    document.querySelectorAll('.dafic-card').forEach(c => c.classList.remove('selected'));
    ele.classList.add('selected');
    
    precioPlanBase = prec; 
    nombrePlan = nom; 
    baseDiagnostico = diag;
    textoExtraPrecio = txtExtra;

    let cardDiag = document.getElementById('card-diagnostico');
    let cardNom = document.getElementById('card-nomina');
    let cardReg = document.getElementById('card-regularizacion');
    let wrapRegimen = document.getElementById('wrapper-regimen-reg');
    let checkDiag = document.getElementById('checkDiagnostico');
    let checkNom = document.getElementById('checkNomina');

    cardReg.style.display = 'none';
    wrapRegimen.style.display = 'none';
    document.getElementById('numMesesReg').value = 1; 
    document.getElementById('txt-descuento').innerText = "";

    const serviciosUnicos = ['Declaraci√≥n Anual PF', 'Devoluci√≥n Impuestos PF', 'Cita SAT', 'Tr√°mite IMSS', 'Generaci√≥n Contrase√±a', 'Devoluci√≥n Impuestos PM', 'Renovaci√≥n e.Firma', 'Asesor√≠a 1:1', 'Estrategia Fiscal'];
    
    if (nom.includes('Regularizaci√≥n Fiscal PF')) {
        // MODO REGULARIZACI√ìN PERSONA F√çSICA
        cardDiag.style.display = 'none';
        cardNom.style.display = 'none';
        cardReg.style.display = 'flex'; 
        wrapRegimen.style.display = 'block'; // Mostramos selector de r√©gimen
        checkDiag.checked = false;
        checkNom.checked = false;
        // Sincronizamos el precio inicial con el selector
        precioPlanBase = parseInt(document.getElementById('regimenRegularizacion').value);
    } else if (nom.includes('Regularizaci√≥n Fiscal PM')) {
        // MODO REGULARIZACI√ìN PERSONA MORAL (Precio fijo inicial)
        cardDiag.style.display = 'none';
        cardNom.style.display = 'none';
        cardReg.style.display = 'flex'; 
        wrapRegimen.style.display = 'none';
        checkDiag.checked = false;
        checkNom.checked = false;
    } else if (serviciosUnicos.includes(nom)) {
        cardDiag.style.display = 'none';
        cardNom.style.display = 'none';
        checkDiag.checked = false;
        checkNom.checked = false;
        cardDiag.classList.remove('active');
        cardNom.classList.remove('active');
    } else {
        cardDiag.style.display = 'flex';
        cardNom.style.display = 'flex';
        checkDiag.checked = true;
        checkNom.checked = false;
        cardDiag.classList.add('active');
        cardNom.classList.remove('active');
    }

    updateNominaVisibility();
    document.getElementById('zona-calculadora').style.display = 'block';
    document.querySelector('.neumorphic-divider').style.display = 'block'; 
    setTimeout(() => { document.getElementById('zona-calculadora').scrollIntoView({behavior: "smooth", block: "center"}); }, 100);
    calcularTotal();
  }

  // NUEVA FUNCI√ìN: Cambia el precio base cuando se elige r√©gimen en regularizaci√≥n
  function cambiarPrecioRegularizacion() {
    precioPlanBase = parseInt(document.getElementById('regimenRegularizacion').value);
    calcularTotal();
  }

  function toggleOption(chkId, cardId) {
    let chk = document.getElementById(chkId);
    let card = document.getElementById(cardId);
    chk.checked = !chk.checked;
    if (chk.checked) card.classList.add('active'); else card.classList.remove('active');
    if(chkId === 'checkNomina') updateNominaVisibility();
    calcularTotal();
  }

  function updateNominaVisibility() {
    let chk = document.getElementById('checkNomina');
    let wrp = document.getElementById('wrapper-contador');
    if (chk.checked) wrp.classList.add('visible'); else wrp.classList.remove('visible');
  }

  function cambiarEmpleados(delta) {
    let input = document.getElementById('numEmpleados');
    let val = parseInt(input.value) + delta;
    if (val < 1) val = 1; input.value = val; calcularTotal();
  }

  function cambiarMeses(delta) {
    let input = document.getElementById('numMesesReg');
    let val = parseInt(input.value) + delta;
    if (val < 1) val = 1; input.value = val; 
    calcularTotal();
  }

  function resetearSeleccion() { 
    precioPlanBase = 0; nombrePlan = ""; baseDiagnostico = 0; textoExtraPrecio = "";
    document.querySelectorAll('.dafic-card').forEach(c => c.classList.remove('selected')); 
    document.getElementById('card-diagnostico').style.display = 'flex';
    document.getElementById('card-nomina').style.display = 'flex';
    document.getElementById('card-regularizacion').style.display = 'none';
    document.getElementById('wrapper-regimen-reg').style.display = 'none';
  }

  function verificarStatus() {
    let st = document.getElementById('clientStatus').value;
    let div = document.getElementById('divAtraso');
    if (st === 'Si') div.style.display = 'block';
    else { div.style.display = 'none'; document.getElementById('clientAtraso').value = ""; }
    actualizarLinks();
  }

  function seleccionarHora(hora, btn) {
    horaSeleccionada = hora;
    document.getElementById('txt-hora-sel').innerText = formatTime(hora);
    let btns = document.querySelectorAll('.time-btn');
    btns.forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    actualizarLinks();
  }
  
  function formatTime(time24) {
    let [h, m] = time24.split(':');
    let ampm = h >= 12 ? 'PM' : 'AM';
    h = h % 12; h = h ? h : 12; 
    return `${h}:${m} ${ampm}`;
  }

  function calcularTotal() {
    let totalDisplay = document.getElementById('total-final');
    let labelDisplay = document.getElementById('label-total');
    let notaDisplay = document.getElementById('nota-diagnostico');
    let totalFinal = 0;

    const serviciosUnicos = ['Declaraci√≥n Anual PF', 'Devoluci√≥n Impuestos PF', 'Cita SAT', 'Tr√°mite IMSS', 'Generaci√≥n Contrase√±a', 'Devoluci√≥n Impuestos PM', 'Renovaci√≥n e.Firma', 'Asesor√≠a 1:1', 'Estrategia Fiscal', 'Regularizaci√≥n Fiscal PF', 'Regularizaci√≥n Fiscal PM'];

    if (nombrePlan.includes('Regularizaci√≥n')) {
        let meses = parseInt(document.getElementById('numMesesReg').value);
        let subtotal = precioPlanBase * meses;
        let porcentaje = (meses >= 12) ? 30 : (meses >= 6 ? 20 : (meses >= 3 ? 10 : 0));
        let descuento = subtotal * (porcentaje / 100);
        totalFinal = subtotal - descuento;

        document.getElementById('txt-descuento').innerText = porcentaje > 0 ? `¬°${porcentaje}% OFF aplicado! Ahorras $${descuento.toLocaleString()}` : "";
        totalDisplay.innerText = "$" + totalFinal.toLocaleString();
        labelDisplay.innerText = `Inversi√≥n Estimada (${meses} meses):`;
        notaDisplay.style.display = "none";
    } else {
        let chkDiag = document.getElementById('checkDiagnostico');
        let montoDiag = baseDiagnostico;
        document.getElementById('costo-diagnostico').innerText = montoDiag.toLocaleString();

        let chkNom = document.getElementById('checkNomina');
        let num = parseInt(document.getElementById('numEmpleados').value);
        let totalNom = chkNom.checked ? num * 30 : 0;
        let mensualidadEstimada = precioPlanBase + totalNom;

        if(chkDiag.checked) {
            totalDisplay.innerText = "$" + montoDiag.toLocaleString();
            labelDisplay.innerText = "Pago Inicial Requerido (Diagn√≥stico):";
            notaDisplay.style.display = "block";
            notaDisplay.innerText = "* Cubriendo este monto iniciamos tu Diagn√≥stico. La mensualidad de $" + mensualidadEstimada.toLocaleString() + " inicia despu√©s.";
        } else {
            totalDisplay.innerText = "$" + mensualidadEstimada.toLocaleString() + textoExtraPrecio;
            labelDisplay.innerText = serviciosUnicos.includes(nombrePlan) ? "Inversi√≥n Estimada:" : "Inversi√≥n Mensual Estimada:";
            notaDisplay.style.display = "none";
        }
    }
    document.getElementById('nombre-plan-display').innerText = nombrePlan;
    actualizarLinks();
  }

  function actualizarLinks() {
    let chkNom = document.getElementById('checkNomina');
    let num = parseInt(document.getElementById('numEmpleados').value);
    let totalNom = chkNom.checked ? num * 30 : 0;
    
    let totalMensaje = "";
    if (nombrePlan.includes('Regularizaci√≥n')) {
        let meses = parseInt(document.getElementById('numMesesReg').value);
        let sub = precioPlanBase * meses;
        let porc = (meses >= 12) ? 0.3 : (meses >= 6 ? 0.2 : (meses >= 3 ? 0.1 : 0));
        let final = sub - (sub * porc);
        let regimenTxt = nombrePlan.includes('PF') ? ` (${document.getElementById('regimenRegularizacion').options[document.getElementById('regimenRegularizacion').selectedIndex].text})` : "";
        totalMensaje = `$${final.toLocaleString()} (Total por ${meses} meses)${regimenTxt}`;
    } else {
        let mens = precioPlanBase + totalNom;
        totalMensaje = `$${mens.toLocaleString()}${textoExtraPrecio}`;
    }

    let nombre = document.getElementById('clientName').value || "No especificado";
    let giro = document.getElementById('clientGiro').value || "No especificado";
    let status = document.getElementById('clientStatus').value || "No especificado";
    let atraso = document.getElementById('clientAtraso').value;
    
    let infoFiscal = status === 'Si' ? `‚Ä¢ Alta SAT: S√ç\n‚Ä¢ Estatus: ${atraso || "Sin especificar"}` : `‚Ä¢ Alta SAT: ${status}`;
    let fechaTxt = fechaSeleccionada || "Pendiente";
    let horaTxt = horaSeleccionada ? formatTime(horaSeleccionada) : "Pendiente";

    let telefono = "5213329780881"; 
    let textoEmpleados = (chkNom.checked && !nombrePlan.includes('Regularizaci√≥n')) ? ` (+ N√≥mina de ${num} empleados)` : "";
    let textoDiag = document.getElementById('checkDiagnostico').checked ? `\n‚Ä¢ PAGO INICIAL (Diagn√≥stico): $${document.getElementById('costo-diagnostico').innerText}` : "";
    
    let mensaje = `Hola DAFIC, quiero agendar mi cita.\n\n` +
                  `üìã *DATOS DEL CLIENTE*\n‚Ä¢ Nombre: ${nombre}\n‚Ä¢ Giro: ${giro}\n${infoFiscal}\n\n` +
                  `üìä *COTIZACI√ìN*\n‚Ä¢ Plan: ${nombrePlan}\n‚Ä¢ Costo Total: ${totalMensaje}${textoEmpleados}` +
                  `${textoDiag}\n\n` +
                  `üìÖ *CITA SOLICITADA*\n‚Ä¢ Fecha: ${fechaTxt}\n‚Ä¢ Hora: ${horaTxt}`;

    document.getElementById('btn-whatsapp-link').href = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje)}`;
  }

  document.addEventListener("DOMContentLoaded", () => {
      document.querySelector('.neumorphic-divider').style.display = 'none';
  });
</script>
</body>
</html>
